{
  "case": "simple",
  "run": 2,
  "complexity": "low",
  "strategy_code": "# === STEP 1: Load Data (MUST use exact field names from APPENDIX) ===\nclose = data.get('price:\u6536\u76e4\u50f9')\nvol = data.get('price:\u6210\u4ea4\u80a1\u6578')\nopen_price = data.get('price:\u958b\u76e4\u50f9')\nhigh = data.get('price:\u6700\u9ad8\u50f9')\nlow = data.get('price:\u6700\u4f4e\u50f9')\n\n# === FUNDAMENTALS (MUST add .shift(1) to avoid look-ahead!) ===\nroe = data.get('fundamental_features:ROE\u7a05\u5f8c').shift(1)       # ROE = ROE\u7a05\u5f8c\neps = data.get('fundamental_features:\u6bcf\u80a1\u7a05\u5f8c\u6de8\u5229').shift(1)   # EPS = \u6bcf\u80a1\u7a05\u5f8c\u6de8\u5229\nmargin = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u7387').shift(1)  # Profit Margin\ndebt = data.get('fundamental_features:\u8ca0\u50b5\u6bd4\u7387').shift(1)      # Debt Ratio\n\n# === VALUATION RATIOS (MUST add .shift(1)) ===\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4').shift(1)       # P/B Ratio\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4').shift(1)           # P/E Ratio\n\n# === MONTHLY REVENUE (MUST add .shift(1)) ===\nrev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536').shift(1)             # Monthly Revenue\nrev_yoy = data.get('monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)').shift(1)  # Revenue YoY Growth %\n\n\n# === STEP 2: Calculate Indicators ===\n# Short-term Moving Average (5 days)\nsma5 = close.average(5)\n# Long-term Moving Average (20 days)\nsma20 = close.average(20)\n\n# Volume Moving Average (5 days) for liquidity filter\nvol_avg5 = vol.average(5)\n\n# === STEP 3: Define Conditions ===\n# Condition 1: Short MA crosses above Long MA (buy signal)\ncond1 = (sma5 > sma20) & (sma5.shift(1) <= sma20.shift(1))\n\n# Condition 2: Price is above both short and long MAs (confirming trend)\ncond2 = (close > sma5) & (close > sma20)\n\n# Condition 3: Adequate liquidity (average daily volume > 50,000 shares)\ncond3 = (vol_avg5 >= 50 * 1000)\n\n# Condition 4: Positive Revenue YoY Growth\ncond4 = (rev_yoy > 0)\n\n# Condition 5: Reasonable ROE (e.g., > 10%)\ncond5 = (roe > 10)\n\n# Condition 6: Price is not too high (e.g., PE ratio < 30, or PB ratio < 5)\ncond6 = (pe < 30) | (pb < 5)\n\n# === STEP 4: Combine & Select ===\n# Combine all conditions\n# We want to buy when short MA crosses above long MA,\n# price confirms the trend,\n# and the company has decent fundamentals (liquidity, revenue growth, ROE, valuation)\nposition = (cond1 & cond2 & cond3 & cond4 & cond5 & cond6).is_largest(10) # Select top 10 stocks that meet all criteria\n\n# === STEP 5: Filter & Backtest (FIXED - copy exactly) ===\nposition = position.loc[start_date:end_date]\nreport = sim(position, fee_ratio=fee_ratio, tax_ratio=tax_ratio, resample=\"M\")",
  "execution_result": {
    "success": true,
    "sharpe_ratio": 0.44499018688263947,
    "error_type": null,
    "error_message": null,
    "metrics": {
      "sharpe_ratio": 0.44499018688263947,
      "total_return": 0.611367376487937,
      "max_drawdown": -0.34314104816045155
    }
  },
  "timestamp": "2025-11-21T12:57:22.208983"
}