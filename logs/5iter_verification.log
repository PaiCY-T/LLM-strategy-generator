
üöÄ Starting 5-iteration test run...

2025-10-16 11:50:43,438 - __main__ - INFO - ======================================================================
2025-10-16 11:50:43,439 - __main__ - INFO - 5-ITERATION TEST RUN - START
2025-10-16 11:50:43,440 - __main__ - INFO - ======================================================================
2025-10-16 11:50:43,441 - __main__ - INFO - Timestamp: 2025-10-16T11:50:43.441032
2025-10-16 11:50:43,441 - __main__ - INFO - Model: google/gemini-2.5-flash
2025-10-16 11:50:43,441 - __main__ - INFO - Target iterations: 5
2025-10-16 11:50:43,442 - __main__ - INFO - Log file: logs/5iteration_test_20251016_115043.log
2025-10-16 11:50:43,442 - __main__ - INFO - 
Ëº∏ÂÖ•ÊàêÂäü!
2025-10-16 11:50:43,677 - __main__ - INFO - ‚úÖ Finlab data loaded successfully
2025-10-16 11:50:43,816 - __main__ - INFO - 
2025-10-16 11:50:43,817 - __main__ - INFO - ======================================================================
2025-10-16 11:50:43,817 - __main__ - INFO - ITERATION 0/4 (0-indexed)
2025-10-16 11:50:43,818 - __main__ - INFO - ======================================================================

============================================================
ITERATION 0
============================================================


[0.5/6] Capturing configuration snapshot...
2025-10-16 11:51:02,512 - src.config.experiment_config_manager - INFO - Configuration snapshot saved for iteration 0
‚úÖ Configuration captured
[1/6] Building prompt...
‚úÖ Prompt ready (7937 chars)

[2/6] Generating strategy with google/gemini-2.5-flash...
Calling OpenRouter API with google/gemini-2.5-flash (attempt 1/3)...
‚úÖ Successfully generated strategy (2457 chars)
‚úÖ Strategy generated (2457 chars)

[2.5/6] Auto-fixing dataset keys...
   Code hash: 13ffd404f247cd86
‚úÖ No fixes needed

[2.7/6] Static validation...
‚úÖ Static validation passed

[3/6] Validating code...
2025-10-16 11:51:07,293 - scripts.validate_code - INFO - Code validation passed - no security violations detected
<string>:13: FutureWarning: The default fill_method='pad' in FinlabDataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
‚úÖ Validation passed

[4/6] Executing in sandbox...
‚ùå Execution failed
   Error: NameError: name 'pd' is not defined...

[5/6] Building feedback...
‚úÖ Feedback generated (124 chars)

[6/6] Recording iteration...
‚úÖ Iteration recorded
‚úÖ Code saved to generated_strategy_loop_iter0.py
2025-10-16 11:51:15,987 - __main__ - ERROR - ‚ùå Iteration 0 EXECUTION FAILURE
2025-10-16 11:51:15,989 - __main__ - INFO - 
2025-10-16 11:51:15,989 - __main__ - INFO - ======================================================================
2025-10-16 11:51:15,990 - __main__ - INFO - ITERATION 1/4 (0-indexed)
2025-10-16 11:51:15,991 - __main__ - INFO - ======================================================================

============================================================
ITERATION 1
============================================================


[0.5/6] Capturing configuration snapshot...
2025-10-16 11:51:35,908 - src.config.experiment_config_manager - INFO - Configuration snapshot saved for iteration 1
‚úÖ Configuration captured
[1/6] Building prompt...
‚úÖ Prompt ready (8440 chars)

[2/6] Generating strategy with google/gemini-2.5-flash...
Calling OpenRouter API with google/gemini-2.5-flash (attempt 1/3)...
‚úÖ Successfully generated strategy (2575 chars)
‚úÖ Strategy generated (2575 chars)

[2.5/6] Auto-fixing dataset keys...
   Code hash: 918efa8c1d6f2725
‚úÖ No fixes needed

[2.7/6] Static validation...
‚úÖ Static validation passed

[3/6] Validating code...
2025-10-16 11:51:40,305 - scripts.validate_code - INFO - Code validation passed - no security violations detected
<string>:12: FutureWarning: The default fill_method='pad' in FinlabDataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
‚úÖ Validation passed

[4/6] Executing in sandbox...
‚úÖ Execution successful
   Metrics: ['total_return', 'annual_return', 'sharpe_ratio', 'max_drawdown', 'win_rate', 'position_count']

[4.5/6] Validating metric integrity...
‚úÖ Metric validation passed

[4.6/6] Validating semantic behavior...
‚úÖ Semantic validation passed

[5/6] Building feedback...
‚úÖ Feedback generated (1731 chars)

[6/6] Recording iteration...
‚úÖ Iteration recorded
‚úÖ Code saved to generated_strategy_loop_iter1.py
2025-10-16 11:52:02,216 - __main__ - INFO - ‚úÖ Iteration 1 SUCCESS (duration: 46.2s)
2025-10-16 11:52:02,217 - __main__ - INFO -    Sharpe: 0.8692
2025-10-16 11:52:02,218 - __main__ - INFO -    Total Return: 0.7022293099044812
2025-10-16 11:52:02,218 - __main__ - INFO -    Current Champion: Iteration 6 (Sharpe 2.4751)
2025-10-16 11:52:02,219 - __main__ - INFO - 
2025-10-16 11:52:02,219 - __main__ - INFO - ======================================================================
2025-10-16 11:52:02,220 - __main__ - INFO - ITERATION 2/4 (0-indexed)
2025-10-16 11:52:02,220 - __main__ - INFO - ======================================================================

============================================================
ITERATION 2
============================================================


[0.5/6] Capturing configuration snapshot...
2025-10-16 11:52:17,381 - src.config.experiment_config_manager - INFO - Configuration snapshot saved for iteration 2
‚úÖ Configuration captured
[1/6] Building prompt...
‚úÖ Prompt ready (8440 chars)

[2/6] Generating strategy with google/gemini-2.5-flash...
Calling OpenRouter API with google/gemini-2.5-flash (attempt 1/3)...
‚úÖ Successfully generated strategy (2582 chars)
‚úÖ Strategy generated (2582 chars)

[2.5/6] Auto-fixing dataset keys...
   Code hash: 2bae0bfa689fbdf5
‚úÖ No fixes needed

[2.7/6] Static validation...
‚úÖ Static validation passed

[3/6] Validating code...
2025-10-16 11:52:21,791 - scripts.validate_code - INFO - Code validation passed - no security violations detected
<string>:12: FutureWarning: The default fill_method='pad' in FinlabDataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
‚úÖ Validation passed

[4/6] Executing in sandbox...
‚úÖ Execution successful
   Metrics: ['total_return', 'annual_return', 'sharpe_ratio', 'max_drawdown', 'win_rate', 'position_count']

[4.5/6] Validating metric integrity...
‚úÖ Metric validation passed

[4.6/6] Validating semantic behavior...
‚úÖ Semantic validation passed

[5/6] Building feedback...
‚úÖ Feedback generated (1912 chars)

[6/6] Recording iteration...
‚úÖ Iteration recorded
‚úÖ Code saved to generated_strategy_loop_iter2.py
2025-10-16 11:52:37,786 - __main__ - INFO - ‚úÖ Iteration 2 SUCCESS (duration: 35.6s)
2025-10-16 11:52:37,786 - __main__ - INFO -    Sharpe: 1.1686
2025-10-16 11:52:37,787 - __main__ - INFO -    Total Return: 0.5073672505730096
2025-10-16 11:52:37,787 - __main__ - INFO -    Current Champion: Iteration 6 (Sharpe 2.4751)
2025-10-16 11:52:37,788 - __main__ - INFO - 
2025-10-16 11:52:37,788 - __main__ - INFO - ======================================================================
2025-10-16 11:52:37,789 - __main__ - INFO - ITERATION 3/4 (0-indexed)
2025-10-16 11:52:37,789 - __main__ - INFO - ======================================================================

============================================================
ITERATION 3
============================================================


[0.5/6] Capturing configuration snapshot...
2025-10-16 11:52:54,197 - src.config.experiment_config_manager - INFO - Configuration snapshot saved for iteration 3
‚úÖ Configuration captured
[1/6] Building prompt...
‚úÖ Prompt ready (10128 chars)

[2/6] Generating strategy with google/gemini-2.5-flash...
Calling OpenRouter API with google/gemini-2.5-flash (attempt 1/3)...
‚úÖ Successfully generated strategy (2780 chars)
‚úÖ Strategy generated (2780 chars)

[2.3/6] Validating champion preservation...
2025-10-16 11:52:58,487 - autonomous_loop - INFO - Preservation validated: ‚úÖ PRESERVED | 2/2 params | similarity 50.00%
‚úÖ Preservation validated - critical patterns maintained

[2.5/6] Auto-fixing dataset keys...
   Code hash: cd85932a557b2159
‚úÖ No fixes needed

[2.7/6] Static validation...
‚úÖ Static validation passed

[3/6] Validating code...
2025-10-16 11:52:58,489 - scripts.validate_code - INFO - Code validation passed - no security violations detected
<string>:13: FutureWarning: The default fill_method='pad' in FinlabDataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
‚úÖ Validation passed

[4/6] Executing in sandbox...
‚úÖ Execution successful
   Metrics: ['total_return', 'annual_return', 'sharpe_ratio', 'max_drawdown', 'win_rate', 'position_count']

[4.5/6] Validating metric integrity...
‚úÖ Metric validation passed

[4.6/6] Validating semantic behavior...
‚úÖ Semantic validation passed

[5/6] Building feedback...
‚úÖ Feedback generated (1878 chars)

[6/6] Recording iteration...
‚úÖ Iteration recorded
‚úÖ Code saved to generated_strategy_loop_iter3.py
2025-10-16 11:53:20,770 - __main__ - INFO - ‚úÖ Iteration 3 SUCCESS (duration: 43.0s)
2025-10-16 11:53:20,771 - __main__ - INFO -    Sharpe: 2.3666
2025-10-16 11:53:20,772 - __main__ - INFO -    Total Return: 0.5604299662430396
2025-10-16 11:53:20,773 - __main__ - INFO -    Current Champion: Iteration 6 (Sharpe 2.4751)
2025-10-16 11:53:20,774 - __main__ - INFO - 
2025-10-16 11:53:20,774 - __main__ - INFO - ======================================================================
2025-10-16 11:53:20,775 - __main__ - INFO - ITERATION 4/4 (0-indexed)
2025-10-16 11:53:20,776 - __main__ - INFO - ======================================================================

============================================================
ITERATION 4
============================================================


[0.5/6] Capturing configuration snapshot...
2025-10-16 11:53:39,200 - src.config.experiment_config_manager - INFO - Configuration snapshot saved for iteration 4
‚úÖ Configuration captured
[1/6] Building prompt...
‚úÖ Prompt ready (10128 chars)

[2/6] Generating strategy with google/gemini-2.5-flash...
Calling OpenRouter API with google/gemini-2.5-flash (attempt 1/3)...
‚úÖ Successfully generated strategy (1882 chars)
‚úÖ Strategy generated (1882 chars)

[2.3/6] Validating champion preservation...
2025-10-16 11:53:42,681 - autonomous_loop - INFO - Preservation validated: ‚úÖ PRESERVED | 2/2 params | similarity 50.00%
‚úÖ Preservation validated - critical patterns maintained

[2.5/6] Auto-fixing dataset keys...
   Code hash: ade2ca352522c7bf
‚úÖ No fixes needed

[2.7/6] Static validation...
‚úÖ Static validation passed

[3/6] Validating code...
2025-10-16 11:53:42,683 - scripts.validate_code - INFO - Code validation passed - no security violations detected
<string>:12: FutureWarning: The default fill_method='pad' in FinlabDataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
‚úÖ Validation passed

[4/6] Executing in sandbox...
‚úÖ Execution successful
   Metrics: ['total_return', 'annual_return', 'sharpe_ratio', 'max_drawdown', 'win_rate', 'position_count']

[4.5/6] Validating metric integrity...
‚úÖ Metric validation passed

[4.6/6] Validating semantic behavior...
‚úÖ Semantic validation passed

[5/6] Building feedback...
‚úÖ Feedback generated (2047 chars)

[6/6] Recording iteration...
‚úÖ Iteration recorded
‚úÖ Code saved to generated_strategy_loop_iter4.py
2025-10-16 11:53:58,446 - __main__ - INFO - ‚úÖ Iteration 4 SUCCESS (duration: 37.7s)
2025-10-16 11:53:58,446 - __main__ - INFO -    Sharpe: 0.8968
2025-10-16 11:53:58,447 - __main__ - INFO -    Total Return: -0.15799373134474953
2025-10-16 11:53:58,449 - __main__ - INFO -    Current Champion: Iteration 6 (Sharpe 2.4751)
2025-10-16 11:53:58,449 - __main__ - INFO - 
2025-10-16 11:53:58,450 - __main__ - INFO - ======================================================================
2025-10-16 11:53:58,451 - __main__ - INFO - 5-ITERATION TEST - COMPLETE
2025-10-16 11:53:58,451 - __main__ - INFO - ======================================================================
2025-10-16 11:53:58,452 - __main__ - INFO - Total iterations: 5
2025-10-16 11:53:58,453 - __main__ - INFO - ‚úÖ Successful: 4
2025-10-16 11:53:58,453 - __main__ - INFO - ‚ùå Failed: 1
2025-10-16 11:53:58,454 - __main__ - INFO -    - Validation failures: 0
2025-10-16 11:53:58,454 - __main__ - INFO -    - Execution failures: 1
2025-10-16 11:53:58,455 - __main__ - INFO - Success rate: 80.0%
2025-10-16 11:53:58,455 - __main__ - INFO - 
2025-10-16 11:53:58,456 - __main__ - INFO - Best Sharpe: 2.3666
2025-10-16 11:53:58,456 - __main__ - INFO - Avg Sharpe: 1.3253
2025-10-16 11:53:58,457 - __main__ - INFO - Median Sharpe: 1.1686
2025-10-16 11:53:58,457 - __main__ - INFO - 
2025-10-16 11:53:58,458 - __main__ - INFO - üèÜ FINAL CHAMPION: Iteration 6
2025-10-16 11:53:58,458 - __main__ - INFO -    Sharpe: 2.4751
2025-10-16 11:53:58,459 - __main__ - INFO -    Champion updates: 0
2025-10-16 11:53:58,459 - __main__ - INFO - 
2025-10-16 11:53:58,460 - __main__ - INFO - Log file saved: logs/5iteration_test_20251016_115043.log
2025-10-16 11:53:58,460 - __main__ - INFO - ======================================================================

‚úÖ Test completed successfully
   Success rate: 80.0%
   Best Sharpe: 2.3666
   Log file: logs/5iteration_test_20251016_115043.log
