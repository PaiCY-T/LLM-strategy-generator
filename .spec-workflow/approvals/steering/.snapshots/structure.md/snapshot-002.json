{
  "id": "snapshot_1761405222932_jqwvm7nby",
  "approvalId": "approval_1761405081324_y17mgjnli",
  "approvalTitle": "Code Structure & Organization - Steering Document",
  "version": 2,
  "timestamp": "2025-10-25T15:13:42.932Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Project Structure\n\n## Directory Organization\n\n```\nfinlab/                           # Project root\n├── .claude/                      # Legacy spec system (DEPRECATED)\n│   └── specs/                    # 19 historical specs\n├── .spec-workflow/               # New spec workflow system (ACTIVE)\n│   ├── specs/                    # Spec documents (requirements, design, tasks)\n│   ├── steering/                 # This directory - project guidance\n│   ├── templates/                # Document templates\n│   └── approvals/                # Approval workflow tracking\n│\n├── src/                          # Source code (153 Python files, 4.8MB)\n│   ├── analysis/                 # Strategy analysis and reporting\n│   ├── backtest/                 # Backtesting metrics and utilities\n│   ├── config/                   # Configuration management\n│   │   └── anti_churn_manager.py\n│   ├── data/                     # Data layer (Finlab API integration)\n│   │   ├── downloader.py\n│   │   ├── cache.py\n│   │   └── freshness.py\n│   ├── evolution/                # Evolution system\n│   │   └── population_manager.py\n│   ├── factor_graph/             # Factor Graph system (Phase B)\n│   │   ├── strategy.py           # Strategy composition\n│   │   ├── factor.py             # Factor base class\n│   │   └── pipeline.py           # Execution pipeline\n│   ├── factor_library/           # 13 reusable factors\n│   │   ├── registry.py           # Factor discovery\n│   │   ├── momentum/             # Momentum factors\n│   │   ├── value/                # Value factors\n│   │   ├── quality/              # Quality factors\n│   │   ├── risk/                 # Risk factors\n│   │   ├── entry/                # Entry signal factors\n│   │   └── exit/                 # Exit strategy factors\n│   ├── feedback/                 # Learning system feedback\n│   │   ├── loop_integration.py\n│   │   ├── rationale_generator.py\n│   │   ├── template_analytics.py\n│   │   └── template_feedback_integrator.py\n│   ├── generators/               # Code generation utilities\n│   ├── innovation/               # Innovation tracking\n│   │   └── validators/\n│   ├── monitoring/               # System monitoring\n│   │   └── variance_monitor.py\n│   ├── mutation/                 # Strategy mutation operators\n│   │   ├── tier2/                # Structural mutations\n│   │   ├── tier3/                # Relational mutations\n│   │   └── tier_selection/       # Tier selection logic\n│   ├── population/               # Population-based learning\n│   ├── recovery/                 # Rollback and recovery\n│   │   └── rollback_manager.py\n│   ├── repository/               # Data persistence\n│   │   ├── hall_of_fame.py       # Champion storage\n│   │   ├── hall_of_fame_yaml.py  # YAML export\n│   │   ├── index_manager.py      # Indexing\n│   │   └── pattern_search.py     # Pattern search\n│   ├── storage/                  # Database layer (future)\n│   ├── templates/                # Strategy templates (4 templates)\n│   │   ├── base_template.py\n│   │   ├── turtle_template.py    # 6-layer AND filtering\n│   │   ├── mastiff_template.py   # Contrarian reversal\n│   │   ├── factor_template.py    # Single-factor ranking\n│   │   └── momentum_template.py  # Momentum + catalyst\n│   ├── tier1/                    # Tier 1 operations\n│   ├── ui/                       # User interface (future)\n│   ├── utils/                    # Utilities\n│   │   ├── logger.py\n│   │   ├── exceptions.py\n│   │   ├── json_logger.py\n│   │   └── template_registry.py\n│   ├── validation/               # Multi-layer validation\n│   │   ├── data_split.py         # Train/Val/Test split\n│   │   ├── walk_forward.py       # Walk-forward analysis\n│   │   ├── bootstrap.py          # Bootstrap CI\n│   │   ├── baseline.py           # Baseline comparison\n│   │   ├── multiple_comparison.py # Bonferroni correction\n│   │   ├── preservation_validator.py\n│   │   ├── metric_validator.py\n│   │   └── template_validator.py\n│   ├── constants.py              # System constants\n│   ├── failure_tracker.py        # Failure pattern tracking\n│   └── liquidity_calculator.py   # Liquidity analysis\n│\n├── tests/                        # Test suite (134 Python files, 926 tests)\n│   ├── backtest/\n│   ├── config/\n│   ├── data/\n│   ├── evolution/\n│   ├── factor_graph/\n│   ├── factor_library/\n│   ├── feedback/\n│   ├── generators/\n│   ├── innovation/\n│   ├── integration/              # End-to-end tests\n│   │   ├── phase0_test_harness.py\n│   │   ├── phase1_test_harness.py\n│   │   └── extended_test_harness.py\n│   ├── monitoring/\n│   ├── mutation/\n│   ├── performance/\n│   ├── population/\n│   ├── recovery/\n│   ├── templates/\n│   ├── tier1/\n│   ├── utils/\n│   └── validation/\n│\n├── artifacts/                    # Runtime artifacts\n│   ├── data/                     # JSON data files\n│   │   ├── failure_patterns.json\n│   │   ├── innovations.jsonl\n│   │   └── template_analytics.json\n│   └── working/                  # Working modules\n│       └── modules/\n│           ├── autonomous_loop.py\n│           ├── claude_code_strategy_generator.py\n│           ├── history.py\n│           ├── iteration_engine.py\n│           └── poc_claude_test.py\n│\n├── config/                       # Configuration files\n│   ├── learning_system.yaml      # Learning system config\n│   ├── 50gen_three_tier_validation.yaml\n│   └── grafana_dashboard.json\n│\n├── docs/                         # Documentation\n│   ├── architecture/             # Architecture documentation\n│   │   ├── FEEDBACK_SYSTEM.md\n│   │   ├── TEMPLATE_SYSTEM.md\n│   │   └── ...\n│   ├── API_CHANGELOG.md\n│   ├── LEARNING_SYSTEM_API.md\n│   ├── MONITORING.md\n│   ├── TROUBLESHOOTING.md\n│   └── YAML_CONFIGURATION_GUIDE.md\n│\n├── examples/                     # Usage examples\n│   ├── ast_mutation_examples.py\n│   ├── factor_registry_usage.py\n│   ├── logging_integration_example.py\n│   └── yaml_strategies/\n│\n├── scripts/                      # Utility scripts\n│   ├── analyze_metrics.py\n│   ├── run_50gen_three_tier_validation.py\n│   ├── test_baseline_metrics.py\n│   └── validate_momentum_strategy.py\n│\n├── data/                         # Data cache (ignored by git)\n│   └── [cached Finlab API responses]\n│\n├── logs/                         # Application logs (ignored by git)\n├── checkpoints/                  # Iteration checkpoints (ignored by git)\n├── hall_of_fame/                 # Champion strategies (JSON)\n│\n├── .env                          # Environment variables (ignored by git)\n├── .gitignore\n├── requirements.txt              # Production dependencies\n├── requirements-dev.txt          # Development dependencies\n└── README.md                     # Project overview\n```\n\n### Key Directory Purposes\n\n**Core System** (`src/`):\n- **analysis/**: Performance analysis and reporting\n- **backtest/**: Backtesting metrics extraction\n- **data/**: Finlab API integration, caching, freshness checking\n- **templates/**: 4 strategy templates with 80%+ success rates\n\n**Learning System** (`src/feedback/`, `src/repository/`):\n- **feedback/**: Template recommendation, rationale generation\n- **repository/**: Hall of Fame, iteration history, pattern search\n- **monitoring/**: Variance tracking, convergence detection\n\n**Validation** (`src/validation/`):\n- **data_split.py**: Train/Val/Test periods (2018-2020/2021-2022/2023-2024)\n- **walk_forward.py**: Rolling window validation (252-day windows)\n- **bootstrap.py**: Statistical significance (1000 iterations)\n- **baseline.py**: Buy-and-Hold 0050, Equal-Weight, Risk Parity\n\n**Factor System** (`src/factor_graph/`, `src/factor_library/`):\n- **factor_graph/**: Strategy composition framework\n- **factor_library/**: 13 reusable factors (Momentum, Value, Quality, Risk, Entry, Exit)\n\n**Configuration** (`config/`):\n- **learning_system.yaml**: Anti-churn, multi-objective validation, exit mutation\n\n**Testing** (`tests/`):\n- 926 tests across 23 modules\n- Unit tests: Component-level validation\n- Integration tests: End-to-end workflows\n- Performance tests: Benchmark critical paths\n\n## Naming Conventions\n\n### Files\n- **Modules**: `snake_case.py` (e.g., `iteration_engine.py`, `hall_of_fame.py`)\n- **Templates**: `{name}_template.py` (e.g., `turtle_template.py`, `mastiff_template.py`)\n- **Tests**: `test_{module}.py` (e.g., `test_data_split.py`, `test_template_validator.py`)\n- **Scripts**: `{action}_{target}.py` (e.g., `run_50gen_three_tier_validation.py`)\n- **Examples**: `{concept}_examples.py` or `{concept}_usage.py`\n\n### Code\n- **Classes/Types**: `PascalCase` (e.g., `TurtleTemplate`, `HallOfFameRepository`, `DataCache`)\n- **Functions/Methods**: `snake_case` (e.g., `recommend_template()`, `validate_strategy()`, `get_champion()`)\n- **Constants**: `UPPER_SNAKE_CASE` (e.g., `MAX_ITERATIONS`, `MIN_SHARPE_THRESHOLD`, `DEFAULT_PARAMS`)\n- **Private members**: `_leading_underscore` (e.g., `_extract_params()`, `_validate_internal()`)\n- **Variables**: `snake_case` (e.g., `sharpe_ratio`, `iteration_num`, `champion_strategy`)\n\n### Spec Names\n- **Format**: `kebab-case` (e.g., `learning-system-enhancement`, `docker-sandbox-security`)\n- **Branches**: `feature/{spec-name}`, `bugfix/{issue}`, `docs/{update}`\n- **Files**: `requirements.md`, `design.md`, `tasks.md`\n\n## Import Patterns\n\n### Import Order (isort + PEP 8)\n1. **Standard library**: `import json`, `import re`, `from typing import Dict`\n2. **Third-party packages**: `import pandas as pd`, `import numpy as np`, `from finlab import data`\n3. **Local application**: `from src.templates import TurtleTemplate`, `from src.repository import HallOfFameRepository`\n4. **Relative imports**: `from .base_template import BaseTemplate` (within same package only)\n\n**Example**:\n```python\n# Standard library\nimport json\nimport re\nfrom dataclasses import dataclass\nfrom typing import Dict, List, Optional\n\n# Third-party packages\nimport pandas as pd\nimport numpy as np\nfrom finlab import data\n\n# Local application\nfrom src.templates import TurtleTemplate\nfrom src.repository import HallOfFameRepository\nfrom src.validation import TemplateValidator\n\n# Relative imports (within templates/ package)\nfrom .base_template import BaseTemplate\nfrom .data_cache import DataCache\n```\n\n### Module/Package Organization\n- **Absolute imports**: Preferred for cross-package imports\n  ```python\n  from src.feedback import TemplateFeedbackIntegrator  # ✅ Preferred\n  from ..feedback import TemplateFeedbackIntegrator    # ❌ Avoid\n  ```\n- **Relative imports**: Only within same package\n  ```python\n  # In src/templates/turtle_template.py\n  from .base_template import BaseTemplate  # ✅ OK (same package)\n  from ..repository import HallOfFameRepository  # ❌ Use absolute instead\n  ```\n- **Package exports**: Use `__init__.py` to expose public API\n  ```python\n  # src/templates/__init__.py\n  __all__ = ['BaseTemplate', 'TurtleTemplate', 'MastiffTemplate', ...]\n  ```\n\n## Code Structure Patterns\n\n### Module/File Organization\nStandard order within Python files:\n\n1. **Shebang + Encoding** (if needed)\n   ```python\n   #!/usr/bin/env python3\n   # -*- coding: utf-8 -*-\n   ```\n\n2. **Module docstring**\n   ```python\n   \"\"\"\n   Module description (Google-style).\n\n   Detailed explanation of module purpose, usage, and key components.\n   \"\"\"\n   ```\n\n3. **Imports** (isort order)\n\n4. **Constants**\n   ```python\n   MAX_ITERATIONS = 200\n   MIN_SHARPE_THRESHOLD = 0.5\n   DEFAULT_PARAMS = {...}\n   ```\n\n5. **Type definitions** (if applicable)\n   ```python\n   from typing import TypedDict\n\n   class ChampionData(TypedDict):\n       code: str\n       metrics: Dict[str, float]\n       iteration: int\n   ```\n\n6. **Main classes**\n   ```python\n   class TurtleTemplate(BaseTemplate):\n       \"\"\"Template class with full docstring.\"\"\"\n\n       def __init__(self):\n           ...\n\n       def public_method(self):\n           ...\n\n       def _private_method(self):\n           ...\n   ```\n\n7. **Helper functions**\n   ```python\n   def extract_strategy_params(code: str) -> Dict[str, Any]:\n       \"\"\"Standalone helper function.\"\"\"\n       ...\n   ```\n\n8. **Main execution** (if script)\n   ```python\n   if __name__ == \"__main__\":\n       main()\n   ```\n\n### Function/Method Organization\n\n**Principles**:\n1. **Input validation first**: Check preconditions, validate types\n2. **Core logic in middle**: Main algorithm/business logic\n3. **Error handling throughout**: Try/except with specific exceptions\n4. **Clear return points**: Single return preferred, multiple if clearer\n\n**Example**:\n```python\ndef recommend_template(\n    self,\n    current_metrics: Optional[Dict[str, Any]] = None,\n    iteration: int = 1,\n    validation_result: Any = None\n) -> TemplateRecommendation:\n    \"\"\"\n    Generate template recommendation.\n\n    Args:\n        current_metrics: Performance metrics (sharpe_ratio, max_drawdown)\n        iteration: Current iteration number\n        validation_result: ValidationResult object\n\n    Returns:\n        TemplateRecommendation with template_name, rationale, params\n\n    Raises:\n        ValueError: If iteration < 1\n    \"\"\"\n    # 1. Input validation\n    if iteration < 1:\n        raise ValueError(f\"Iteration must be >= 1, got {iteration}\")\n\n    # 2. Core logic\n    sharpe = current_metrics.get('sharpe_ratio', 0.0) if current_metrics else 0.0\n\n    # Check exploration mode\n    if self._should_force_exploration(iteration):\n        return self._select_exploration_template(iteration)\n\n    # Performance-based selection\n    template_name = self._select_by_performance_tier(sharpe)\n\n    # 3. Enhancement and return\n    params = self._enhance_with_champion_params(template_name)\n    rationale = self._generate_rationale(template_name, sharpe)\n\n    return TemplateRecommendation(\n        template_name=template_name,\n        rationale=rationale,\n        suggested_params=params\n    )\n```\n\n### File Organization Principles\n1. **One primary class per file**: `TurtleTemplate` in `turtle_template.py`\n2. **Related helpers in same file**: Template-specific helpers with template class\n3. **Shared utilities in utils/**: Generic helpers in `src/utils/`\n4. **Public API at top**: Main class/function before internal helpers\n5. **Private details at bottom**: `_private_methods()` after public API\n\n## Code Organization Principles\n\n### 1. **Single Responsibility**\nEach file/class/function has one clear, well-defined purpose.\n\n**Good Examples**:\n- `turtle_template.py`: Only TurtleTemplate implementation\n- `hall_of_fame.py`: Only champion strategy storage\n- `variance_monitor.py`: Only convergence monitoring\n\n**Anti-patterns to avoid**:\n- Mixed concerns (e.g., template + validation in same class)\n- God classes (e.g., single class doing generation + backtest + analysis)\n\n### 2. **Modularity**\nCode organized into reusable, composable modules.\n\n**Examples**:\n- Factor library: 13 independent factors composable into strategies\n- Validation components: 5 validators usable individually or together\n- Templates: 4 templates with shared base class\n\n### 3. **Testability**\nStructure code to facilitate testing.\n\n**Patterns**:\n- Dependency injection: Pass dependencies via constructor\n  ```python\n  def __init__(self, repository: HallOfFameRepository):\n      self.repository = repository  # ✅ Testable (can mock)\n  ```\n- Pure functions: Input → Output, no side effects\n  ```python\n  def calculate_sharpe(returns: pd.Series) -> float:\n      return returns.mean() / returns.std()  # ✅ Pure function\n  ```\n- Clear interfaces: Type hints, docstrings, explicit contracts\n\n### 4. **Consistency**\nFollow established patterns throughout codebase.\n\n**Established Patterns**:\n- Repository pattern: `HallOfFameRepository`, `IterationHistory`\n- Manager suffix: `AntiChurnManager`, `RollbackManager`\n- Validator suffix: `TemplateValidator`, `PreservationValidator`\n- Generator suffix: `RationaleGenerator`\n\n### 5. **避免過度工程化** (Project Principle)\nKeep implementation simple and pragmatic.\n\n**Applications**:\n- JSON persistence instead of PostgreSQL (sufficient for personal use)\n- Regex parameter extraction instead of AST (80/20 solution, 90% accuracy)\n- CLI-based instead of web dashboard (faster development)\n\n## Module Boundaries\n\n### Core vs Plugins\n- **Core**: src/templates/, src/factor_graph/, src/validation/\n- **Plugins**: Custom templates can be added (future extensibility)\n- **Boundary**: BaseTemplate interface defines plugin contract\n\n### Public API vs Internal\n- **Public API**: Exported via `__all__` in `__init__.py`\n  ```python\n  # src/templates/__init__.py\n  __all__ = ['BaseTemplate', 'TurtleTemplate', 'MastiffTemplate', ...]\n  ```\n- **Internal**: `_private_methods()`, `_helper_functions()`\n- **Boundary**: Leading underscore convention\n\n### Stable vs Experimental\n- **Stable**: src/templates/, src/validation/, src/repository/ (tested, documented)\n- **Experimental**: src/innovation/, new mutation operators (subject to change)\n- **Boundary**: Documented in module docstrings, STATUS.md files\n\n### Dependencies Direction\n**Allowed dependencies** (acyclic, layered):\n```\n┌─────────────┐\n│ Iteration   │\n│ Engine      │\n└──────┬──────┘\n       │\n   ┌───▼────────┬─────────────┬──────────────┐\n   │            │             │              │\n┌──▼──────┐ ┌──▼────┐  ┌────▼────┐  ┌──────▼──────┐\n│Templates│ │Factor │  │Feedback │  │Validation   │\n│         │ │ Graph │  │         │  │             │\n└──┬──────┘ └──┬────┘  └────┬────┘  └──────┬──────┘\n   │           │             │              │\n   └───────┬───┴─────────────┴──────────────┘\n           │\n      ┌────▼─────┐\n      │Repository│\n      │          │\n      └────┬─────┘\n           │\n      ┌────▼────┐\n      │Backtest │\n      │ (finlab)│\n      └────┬────┘\n           │\n      ┌────▼────┐\n      │  Data   │\n      └─────────┘\n```\n\n**Forbidden dependencies** (circular):\n- ❌ Repository → Templates (would create cycle)\n- ❌ Data → Validation (too high-level)\n- ❌ Backtest → Feedback (layers crossed)\n\n## Code Size Guidelines\n\n### File Size\n- **Target**: <500 lines per file\n- **Maximum**: 1000 lines (consider splitting)\n- **Exceptions**: Large validation modules (1200-1700 lines acceptable if cohesive)\n\n**Current Stats**:\n- Average file size: ~300 lines\n- Largest files: validation modules (1200-1700 lines)\n- Smallest files: constants, simple utilities (<100 lines)\n\n### Function/Method Size\n- **Target**: <50 lines per function\n- **Maximum**: 100 lines (consider extracting helpers)\n- **Ideal**: 10-30 lines (single responsibility)\n\n### Class Complexity\n- **Target**: <10 public methods per class\n- **Maximum**: 20 methods (consider splitting responsibilities)\n- **Private methods**: No strict limit (implementation details)\n\n### Nesting Depth\n- **Target**: ≤2 levels of nesting\n- **Maximum**: 3 levels (consider early returns or extraction)\n\n**Example** (good):\n```python\ndef process_iteration(iteration: int) -> Result:\n    if not is_valid(iteration):  # Level 1\n        return error_result\n\n    for strategy in strategies:  # Level 1\n        if meets_criteria(strategy):  # Level 2\n            results.append(process(strategy))\n\n    return results\n```\n\n**Example** (avoid):\n```python\ndef process_iteration(iteration: int) -> Result:\n    if is_valid(iteration):  # Level 1\n        for strategy in strategies:  # Level 2\n            if meets_criteria(strategy):  # Level 3\n                if passes_validation(strategy):  # Level 4 ❌ Too deep!\n                    results.append(process(strategy))\n```\n\n## Dashboard/Monitoring Structure\n\n### Current Structure (CLI-based)\n```\n# No dashboard yet - CLI logging only\nartifacts/working/modules/\n├── autonomous_loop.py         # Main iteration loop\n├── iteration_engine.py        # Execution engine\n└── history.py                 # Iteration history tracking\n```\n\n**Monitoring**:\n- Structured JSON logging (`src/utils/json_logger.py`)\n- Rich terminal output (`rich` library)\n- Progress bars (`tqdm`)\n- Metrics export (JSON, Prometheus)\n\n### Future Dashboard Structure (Planned)\n```\nsrc/\n└── dashboard/                 # Self-contained subsystem\n    ├── server/                # FastAPI backend\n    │   ├── api/\n    │   ├── services/\n    │   └── main.py\n    ├── client/                # React frontend (or Streamlit)\n    │   ├── components/\n    │   ├── pages/\n    │   └── App.tsx\n    ├── shared/                # Shared types/utilities\n    │   └── types.ts\n    └── public/                # Static assets\n```\n\n### Separation of Concerns\n- **Dashboard isolated from core**: Can be disabled without affecting autonomous loop\n- **Own CLI entry point**: `python -m src.dashboard` (independent operation)\n- **Minimal dependencies**: Only depends on repository layer (read-only access)\n- **API-first design**: REST API can be used by other tools\n\n## Documentation Standards\n\n### Code Documentation\n- **All public APIs**: Must have Google-style docstrings\n  ```python\n  def recommend_template(\n      self,\n      current_metrics: Optional[Dict[str, Any]] = None\n  ) -> TemplateRecommendation:\n      \"\"\"\n      Generate template recommendation based on performance metrics.\n\n      Args:\n          current_metrics: Dictionary with 'sharpe_ratio', 'max_drawdown', etc.\n\n      Returns:\n          TemplateRecommendation with template_name, rationale, params\n\n      Raises:\n          ValueError: If current_metrics is invalid\n\n      Example:\n          >>> recommendation = integrator.recommend_template({'sharpe_ratio': 0.8})\n          >>> print(recommendation.template_name)\n          'TurtleTemplate'\n      \"\"\"\n  ```\n\n- **Complex logic**: Inline comments explaining \"why\", not \"what\"\n  ```python\n  # Use hybrid threshold to prevent stagnation at high Sharpe (>2.0)\n  # Relative threshold becomes too strict (5% of 2.5 = 2.625 impossible)\n  relative_met = new_sharpe >= old_sharpe * (1 + relative_threshold)\n  absolute_met = new_sharpe >= old_sharpe + additive_threshold\n  ```\n\n- **Module-level**: Comprehensive docstring at file top\n  ```python\n  \"\"\"\n  Template Feedback Integration System\n  =====================================\n\n  Intelligent template recommendation and feedback for autonomous learning.\n\n  Key Components:\n      - TemplateFeedbackIntegrator: Performance-based template selection\n      - RationaleGenerator: Natural language explanations\n      - TemplateAnalytics: Usage tracking and statistics\n\n  Usage:\n      from src.feedback import TemplateFeedbackIntegrator\n\n      integrator = TemplateFeedbackIntegrator()\n      recommendation = integrator.recommend_template(metrics, iteration=1)\n  \"\"\"\n  ```\n\n### Architecture Documentation\n- **Major modules**: README.md in subdirectory\n- **System architecture**: `docs/architecture/` (FEEDBACK_SYSTEM.md, TEMPLATE_SYSTEM.md, etc.)\n- **API documentation**: `docs/*_API.md` (LEARNING_SYSTEM_API.md, etc.)\n- **Troubleshooting**: `docs/TROUBLESHOOTING.md`\n\n### Spec Documentation\n- **Requirements**: `.spec-workflow/specs/{spec}/requirements.md`\n- **Design**: `.spec-workflow/specs/{spec}/design.md`\n- **Tasks**: `.spec-workflow/specs/{spec}/tasks.md`\n- **Status**: `.spec-workflow/specs/{spec}/STATUS.md`\n\n### Language\n- **Code comments**: English\n- **Documentation**: 中英雙語 (bilingual Chinese/English)\n- **README**: Comprehensive sections in both languages\n- **Inline comments**: English preferred, Chinese acceptable for complex domain logic\n\n## Special Conventions\n\n### Iteration Numbering\n- **0-indexed internally**: `iteration_num = 0` is first iteration\n- **1-indexed in logs**: Display as \"Iteration 1\" for user clarity\n- **Conversion**: `display_num = iteration_num + 1`\n\n### Checkpoint Naming\n- **Format**: `{prefix}_checkpoints/`, `{prefix}_checkpoint_{iteration}.json`\n- **Examples**: `baseline_checkpoints/`, `validation_checkpoints/`, `phase1_checkpoints/`\n\n### Metrics Naming\n- **snake_case**: `sharpe_ratio`, `max_drawdown`, `calmar_ratio`\n- **Negative values**: Drawdowns are negative (e.g., `-0.15` for 15% drawdown)\n- **Percentages**: Use decimals (0.05 = 5%), not integers (5)\n\n### Template Names\n- **Suffix**: Always end with \"Template\" (e.g., `TurtleTemplate`, not `Turtle`)\n- **PascalCase**: Class names in code\n- **Title Case**: Display names (\"Turtle Template\")\n\n### File Timestamps\n- **Format**: ISO 8601 (`2025-10-25T14:53:26.979Z`)\n- **Timezone**: UTC for consistency\n- **Filenames**: `YYYY-MM-DD` format if needed (e.g., `backup_2025-10-25.json`)\n\n---\n\n**Document Version**: 1.0\n**Last Updated**: 2025-10-25\n**Status**: Draft - Pending Approval\n**Maintainer**: Personal Project\n",
  "fileStats": {
    "size": 26297,
    "lines": 706,
    "lastModified": "2025-10-25T15:11:14.439Z"
  },
  "comments": []
}