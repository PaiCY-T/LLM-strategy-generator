{
  "genome_id": "autonomous_generated_20251102_182608_2.56",
  "template_name": "autonomous_generated",
  "parameters": {
    "datasets": [
      "etl:adj_close",
      "etl:market_value",
      "fundamental_features:營業利益率",
      "institutional_investors_trading_summary:投信買賣超股數",
      "price:成交金額",
      "price_earning_ratio:股價淨值比"
    ],
    "liquidity_threshold": 70,
    "roe_smoothing_window": null,
    "roe_type": "not_used",
    "revenue_handling": "not_used",
    "value_factor": "pb_ratio",
    "price_filter": 20,
    "volume_filter": null,
    "factor_combination": "op_margin_rank * 0.30 +                    pb_rank * 0.25 +                    market_cap_rank * 0.20 +                    it_strength_rank * 0.25",
    "__iteration_num__": 3
  },
  "metrics": {
    "total_return": -0.2215752911489399,
    "annual_return": 0.2257798618295586,
    "sharpe_ratio": 2.5604600394789623,
    "max_drawdown": -0.16699112669862057,
    "win_rate": 0.23850480201015906,
    "position_count": 252
  },
  "created_at": "2025-11-02 18:26:08",
  "strategy_code": "# 1. Load data\nclose = data.get('etl:adj_close')  # ✅ Adjusted for dividends/splits, used for price filter\ntrading_value = data.get('price:成交金額')  # OK for liquidity filter\noperating_margin = data.get('fundamental_features:營業利益率')  # Underused: Quality/Profitability\npb_ratio = data.get('price_earning_ratio:股價淨值比')  # Underused: Value\nmarket_value = data.get('etl:market_value')  # Underused: Size\ninvestment_trust_strength = data.get('institutional_investors_trading_summary:投信買賣超股數') # Underused: Institutional Conviction\n# 2. Calculate factors\n# Factor 1: Quality - Operating Profit Margin (4-quarter average for stability)\n# Higher operating margin indicates better core business profitability.\nop_margin_factor = operating_margin.ffill().rolling(4).mean().shift(1)\n# Factor 2: Value - Price-to-Book Ratio\n# Lower P/B ratio indicates potential undervaluation.\npb_factor = pb_ratio.shift(1)\n# Factor 3: Size - Market Capitalization\n# Favor smaller to mid-cap stocks for potential growth, but within a reasonable range.\nmarket_cap_factor = market_value.shift(1)\n# Factor 4: Institutional Conviction - Investment Trust Buying Strength\n# Higher strength indicates domestic institutional interest and potential upward momentum.\nit_strength_factor = investment_trust_strength.shift(1)\n# 3. Combine factors (normalize first!)\n# Normalize each factor to percentile ranks [0, 1]\nop_margin_rank = op_margin_factor.rank(axis=1, pct=True)\n# For P/B and Market Cap, lower values are better, so reverse the rank\npb_rank = (1 - pb_factor.rank(axis=1, pct=True))\nmarket_cap_rank = (1 - market_cap_factor.rank(axis=1, pct=True))\nit_strength_rank = it_strength_factor.rank(axis=1, pct=True)\n# Combine with unique weights\ncombined_factor = (op_margin_rank * 0.30 +\n                   pb_rank * 0.25 +\n                   market_cap_rank * 0.20 +\n                   it_strength_rank * 0.25)\n# 4. Apply filters\n# Liquidity filter: Average trading value over 20 days > 70M TWD\nliquidity_filter = trading_value.rolling(20).mean().shift(1) > 70_000_000\n# Price filter: Stock price > 20 TWD to avoid penny stocks\nprice_filter = close.shift(1) > 20\n# Market Cap Range Filter: Select mid-to-small cap stocks (1B to 20B TWD)\n# This adds structural diversity by targeting a specific market segment.\nmarket_cap_range_filter = (market_value.shift(1) > 1_000_000_000) & \\\n                          (market_value.shift(1) < 20_000_000_000)\n# Apply all filters\nfiltered_factor = combined_factor[liquidity_filter & price_filter & market_cap_range_filter]\n# 5. Select stocks\n# Select top 10 stocks based on the combined factor score\nposition = filtered_factor.is_largest(10)\n# 6. Run backtest\nreport = sim(position, resample=\"Q\", upload=False, stop_loss=0.08)",
  "success_patterns": [
    "price > 20 TWD - Filters penny stocks",
    "market_cap filter - Size-based stock selection"
  ]
}